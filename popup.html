<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Focals · Réglages</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif; margin: 0; padding: 16px; color: #e5e7eb; background: #0f172a; min-width: 360px; }
    h1 { font-size: 18px; margin: 0 0 12px 0; }
    h2 { font-size: 16px; margin: 20px 0 8px 0; }
    label { display: block; font-size: 12px; color: #cbd5e1; margin-bottom: 4px; }
    select, input, textarea { width: 100%; padding: 8px; border-radius: 8px; border: 1px solid #1f2937; background: #111827; color: #f8fafc; box-sizing: border-box; }
    textarea { resize: vertical; min-height: 80px; }
    button { background: #2563eb; color: #fff; border: none; border-radius: 8px; padding: 10px 12px; cursor: pointer; font-weight: 600; }
    button.secondary { background: #1f2937; color: #e5e7eb; }
    button.danger { background: #b91c1c; }
    .section { background: #0b1220; border: 1px solid #1f2937; border-radius: 12px; padding: 12px; margin-bottom: 12px; }
    .row { display: flex; gap: 8px; align-items: center; }
    .list { display: flex; flex-direction: column; gap: 8px; margin-top: 8px; }
    .list-item { background: #111827; border: 1px solid #1f2937; border-radius: 10px; padding: 8px; display: flex; justify-content: space-between; gap: 8px; align-items: center; }
    .list-item strong { display: block; color: #fff; }
    .list-item small { color: #cbd5e1; }
    .pill { display: inline-block; padding: 2px 8px; border-radius: 999px; background: #1f2937; color: #cbd5e1; font-size: 11px; margin-left: 6px; }
    .muted { font-size: 12px; color: #94a3b8; }
    .grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 8px; }
    .tabs { display: flex; gap: 8px; margin-bottom: 12px; }
    .tab-btn { flex: 1; padding: 8px 10px; border-radius: 10px; border: 1px solid #1f2937; background: #111827; color: #e5e7eb; cursor: pointer; font-weight: 600; }
    .tab-btn.active { background: #1e3a8a; border-color: #1e3a8a; color: #fff; }
    .profile-card { background: #0b1220; border: 1px solid #1f2937; border-radius: 12px; padding: 12px; display: flex; gap: 12px; align-items: center; }
    .profile-info { flex: 1; }
    .profile-name { font-weight: 700; font-size: 15px; color: #fff; }
    .profile-sub { color: #cbd5e1; font-size: 13px; }
    .profile-meta { color: #94a3b8; font-size: 12px; margin-top: 4px; }
    .avatar { width: 56px; height: 56px; border-radius: 50%; object-fit: cover; border: 1px solid #1f2937; }
    .pill-inline { display: inline-block; padding: 2px 8px; border-radius: 999px; background: #1f2937; color: #cbd5e1; font-size: 11px; margin-right: 6px; }
  </style>
</head>
<body>
  <h1>Focals</h1>
  <div class="tabs">
    <button id="tabProfile" class="tab-btn active">Profil</button>
    <button id="tabSettings" class="tab-btn">Paramètres</button>
  </div>

  <div id="profileView" class="section" style="display:block;">
    <h2 style="margin-top:0">Profil LinkedIn</h2>
    <div id="profileCard" class="profile-card">
      <div class="profile-info">
        <div class="profile-name">Aucun profil détecté</div>
        <div class="profile-sub muted">Ouvrez un profil LinkedIn (/in/...) puis rechargez.</div>
      </div>
    </div>
    <div class="row" style="margin-top:10px; gap:8px; align-items:center;">
      <button id="refreshProfile" class="secondary" style="flex:1">Rafraîchir</button>
      <button id="associateProfile" style="flex:1">Associer</button>
    </div>
    <div class="muted" id="profileStatus" style="margin-top:6px;"></div>

  </div>

  <div id="settingsView" style="display:none;">
  <div class="section">
    <h2>Ton par défaut</h2>
    <label for="toneSelect">Sélectionnez le ton utilisé pour les réponses</label>
    <select id="toneSelect">
      <option value="very_formal">Très formel</option>
      <option value="professional">Professionnel</option>
      <option value="warm">Chaleureux</option>
      <option value="direct">Direct</option>
    </select>
  </div>

  <div class="section">
    <div class="row" style="justify-content: space-between; align-items: center;">
      <h2 style="margin:0">Modèles</h2>
      <button id="addTemplate" class="secondary">Nouveau modèle</button>
    </div>
    <div id="templatesList" class="list"></div>
    <div id="templateForm" style="margin-top: 12px; display: none;">
      <label for="templateLabel">Nom du modèle</label>
      <input id="templateLabel" type="text" placeholder="Ex: Relance chaleureuse" />
      <div class="grid" style="margin-top:8px;">
        <div>
          <label for="templateLanguage">Langue</label>
          <select id="templateLanguage">
            <option value="fr">Français</option>
            <option value="en">English</option>
          </select>
        </div>
        <div>
          <label for="templateId">Identifiant</label>
          <input id="templateId" type="text" placeholder="relance_warm" />
        </div>
      </div>
      <label for="templateContent" style="margin-top:8px;">Contenu (placeholders: {firstName}, {company}, {role})</label>
      <textarea id="templateContent"></textarea>
      <div class="row" style="justify-content:flex-end; margin-top:8px;">
        <button id="cancelTemplate" class="secondary">Annuler</button>
        <button id="saveTemplate">Enregistrer</button>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="row" style="justify-content: space-between; align-items: center;">
      <h2 style="margin:0">Offres / Jobs</h2>
      <button id="addJob" class="secondary">Ajouter un job</button>
    </div>
    <div id="jobsList" class="list"></div>
    <div id="jobForm" style="margin-top: 12px; display: none;">
      <div class="grid">
        <div>
          <label for="jobTitle">Titre</label>
          <input id="jobTitle" type="text" placeholder="Product Manager" />
        </div>
        <div>
          <label for="jobCompany">Entreprise</label>
          <input id="jobCompany" type="text" placeholder="Focals" />
        </div>
      </div>
      <div class="grid" style="margin-top:8px;">
        <div>
          <label for="jobLanguage">Langue</label>
          <select id="jobLanguage">
            <option value="fr">Français</option>
            <option value="en">English</option>
          </select>
        </div>
        <div>
          <label for="jobId">Identifiant</label>
          <input id="jobId" type="text" placeholder="pm_focals" />
        </div>
      </div>
      <label for="jobDescription" style="margin-top:8px;">Description (brève)</label>
      <textarea id="jobDescription"></textarea>
      <label for="jobSummary" style="margin-top:8px;">Résumé (optionnel)</label>
      <textarea id="jobSummary"></textarea>
      <div class="row" style="justify-content:flex-end; margin-top:8px;">
        <button id="cancelJob" class="secondary">Annuler</button>
        <button id="saveJob">Enregistrer</button>
      </div>
    </div>
  </div>

  <div class="section">
    <h2>Clé OpenAI</h2>
    <p class="muted">Stockée uniquement en local via chrome.storage.sync</p>
    <input id="apiKey" type="password" placeholder="sk-..." />
    <div class="row" style="justify-content:flex-end; margin-top:8px;">
      <button id="saveApiKey">Enregistrer la clé</button>
    </div>
  </div>

  <div class="muted" id="status"></div>
  </div>

  <script type="module" src="popup.js"></script>
</body>
</html>
